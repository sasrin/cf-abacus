<!--
Frequently Asked Questions (FAQ)
-->
良くある質問(FAQ)
===

<!--
### How does the report generated by the demo relate to the submitted usage and rate data?
-->
### デモでは、入力した利用量と単価データからどのようにレポートを生成しているのでしょうか？

<!--
A resource provider controls how usage is metered, accumulated, aggregated, rated, summarized and charged through a set of Javascript functions (meter, accumulate, aggregate, rate, summarize, charge) that can be configured in a resource configuration JSON document.
-->
リソースプロバイダはどのように利用量を集め、積算し、集計し、課金額を計算し、サマリーを作成し、請求するかをJavaScript関数(meter, accumulate, aggregate, rate, summarize, charge)で制御します。これらは、リソース設定のJSONドキュメントに記載されています。

<!--
These functions are called to process submitted usage as it flows through the Abacus meter, accumulator, aggregator and reporting services in the following sequence:
-->
下記のシーケンスのとおり、これらの関数はAbacusのmeter、accumulator、aggregatorそしてレポートサービスを通して登録された利用量を処理するために呼ばれます。

<!--
- the resource provider submits usage docs containing usage measures (e.g. number of API calls, or bytes of storage or memory);
-->
- リソースプロバイダは計測した値(例えばAPIのコール数、ストレージやメモリのバイト数など)が含まれている利用量ドキュメントを登録します。

<!--
- the resource provider's meter() function is called, given the usage measures, and is responsible for converting them to the metrics relevant for the particular resource (e.g. thousands of API calls, GB of storage, MB of memory);
-->
- 利用量が与えられて、リソースプロバイダの定義したmeter()関数が呼び出さます。
そして、リソースの種類に関連したメトリクス(例えばAPIのコール数、ストレージやメモリのバイト数を千単位に変換するなど)が返却されます。

<!--
- the provider's accumulate() function is called, responsible for accumulating (usually a simple sum) the particular metric over time (per sec, min, hour, day, month etc);
-->
- プロバイダのaccumulate()関数が呼び出され、単位時間毎(秒毎、分毎、時間毎、日毎、月毎など)に積算(通常であれば単純な足し算)された値が返却されます。

<!--
- the provider's aggregate() function is called next, responsible for aggregating (usually a sum as well) the particular metric at different levels under an organization;
-->
- 次に、プロバイダのaggregate()関数が呼び出され、組織内の異なるレベルのメトリクスが集計(通常は足し算)されて返却されます。

<!--
- next, the provider's rate() function is called, responsible for computing the cost of the metric given the usage and the price of the particular metric;
-->
- 次に、プロバイダのrate()関数が呼び出され、利用量とメトリクスに応じた単価から課金額が算出されて返却されます。

<!--
- finally the summarize() and charge() functions are called to compute the final usage summary and corresponding charges, at the time the usage summary report gets produced.
-->
- 最後にsummarize()とcharge()関数が呼び出され、利用量サマリサポートを作成するために最終的な利用量サマリと、それに関連する課金額が計算されます。

<!--
On a final note, usage measures and metrics can be expressed as simple numbers (e.g. a decimal number representing a number of API calls) or compound data structures for more sophisticated usage metering schemes (e.g the ability to represent something like 'already consumed 153GB of memory and now consuming 3GB since 9:32am today'); the provider's meter, accumulate, aggregate etc functions are then free to interpret the data structure representing the metric however they want.
-->
備考として、利用量の計測とメトリクスは単純な数値(例えばAPIコール数に応じたdecimal)か、あるいはデータ構造を組み合わせたより高度な計測方法
(例えば「すでに153GBのメモリが利用され、本日9:32AMから3GBが利用」)で表現することが可能です。
プロバイダのmeter、accumulate、aggregateなどの関数は、メトリクスに代表されるデータ構造を自由に扱うことができます。


<!--
### How to get Usage Data from CF?
-->
### CFからどのようにして利用データを取得すれば良いですか？

<!--
We are currently building a prototype for reporting Cloud Foundry app runtime usage data to Abacus. You can have a look at the CF bridge [source](../lib/cf/bridge).
-->
現在、CFアプリの利用量をAbacusにレポートするためのプロトタイプを構築中です。[source](../lib/cf/bridge)でブリッジしているソースを確認することができます。

<!--
What we currently do is to:
1. obtain oauth token
2. list app usage events
3. report linux-container metrics
-->
現時点で行っていることは次のとおりです:
1. oauthトークンの取得
2. アプリ利用量イベントのリストアップ
3. linux-containerのメトリクスレポート

<!--
For now we basically report the memory used.
-->
今は基本的にメモリ利用量を集計しています。

<!--
The same approach can be applied to service usage events. However we're not aware of any useful metrics (besides the number of instances) present in the service usage events. This is due to the fact that CF does not know what the service actually does.  Instead the service providers can report the metrics they want to charge for to Abacus. This can happen in the service broker itself or in dedicated bridge that fetches the metrics from the broker and reports the usage to Abacus.
-->
同様のアプローチをサービス利用イベントに適用することが可能です。しかしながら、私はサービス利用イベント内で、(インスタンス数を除いて)何が便利なメトリクスなのか十分には分かっていません
これはCFから見て、アプリケーションが何をしているのか分からない(分かるべきではない)ということに起因しています。
その代わりに、サービスプロバイダの要求に応じてメトリクスが集計されるようにAbacusを変更することができます。
これにより、サービスブローカー(サービス仲介者)や専用ブリッジが必要な場合、ブローカーからメトリクスを取り出してAbacusに利用レポートとして取り込むことも可能です。

<!--
### Is there an API to cancel or correct entries?
-->
### エントリーをキャンセルもしくは訂正するためのAPIはありますか？

<!--
Our current strategy is to have the service or runtime provider submit compensating usage (e.g. if that service provider thinks it has submitted too much GB hours for example, he can always compensate that with a negative/credit usage later). If there's a mistake, it's compensated later, we don't rewrite history, for many reasons including auditing, potentially legal reasons etc...
-->
現在の設計では、サービスまたはランタイムのプロバイダが相殺する利用ログ(例えば、サービスプロバイダが余分なGB時間を登録してしまった場合、その分をマイナスしたログ)を登録しなければなりません。
誤った処理によって相殺するデータを登録した場合、証跡や将来的な法的根拠を含むさまざまな理由により、我々は履歴を書き換えることは行いません。

<!--
The other thing to consider is that even if there was a way to rewrite history, that wouldn't handle the cases where the mistaken usage would have already been shown to the customer (as customers are typically able to see their usage in close to real time) or, even more difficult... the cases where that usage would have already been billed to that customer (e.g. the mistake happened on 08/31 23:30pm and only got discovered on 09/01 after a bill was produced and sent to the customer...)
-->
その他に考えなければいけないこととして、もし履歴を書き換える方法が存在したとしても、(通常、顧客はリアルタイムに近い状態で顧客自身の利用量を確認することができるため)顧客がすでに間違った利用量を見ていた場合は対応することはできません。
また、さらに困難なケースとして、(8/31 23:30にミスが発生し、9/1より後に請求書が送られた後にそのミスが発覚した場合など)顧客がすでに利用料金を支払った場合も考えられます。

<!--
### Can one configure CF-Abacus for a trial period?
-->
### トライアル期限をCF-Abacusで設定できますか？

<!--
Abacus allows you to completely control how usage and costs are accumulated over time, and aggregated at various levels inside an organization using Javascript functions that you can define yourself for each resource, so yes you should be able to implement that kind of logic.
-->
Abacusでは、利用量や費用をどのように積算していくかは完全に利用側で制御することができます。
また、組織内のさまざまなレベルに対して、利用者自身がリソースに応じて任意に定義(すなわち、ロジックを実装することが可能)できるJavaScript関数を用いて集計処理を行うことも可能です。

<!--
We are actually in the middle of implementing time windows (sec, min, hour, day, month, year) for usage accumulation so when that's in place it'll be even easier to do it.
-->
実際、上述の制御を簡単に行うため、利用量を積算する際の時間窓(秒、分、時間、日、月、年)を実装しているところです。

<!--
Another thing to consider is that Abacus doesn't do billing/invoicing. We meter, aggregate and rate usage to produce usage and charge summary reports that can then be fed to a billing system. Your particular billing system can eventually decide to apply discounts or 'just make it free for that customer' for example on top of the usage and rating data that Abacus provided.
-->
他に考えるべきこととして、Abacusは課金処理や請求処理は行わないということがあります。
Abacusは利用量の計測、集計、評価を行い、課金システムと連携するための利用量と課金額のサマリーレポートを提供します。
あなたの特定の課金システムは、最終的にディスカウントや「この顧客には無料で提供する」などを決定します。

<!--
### Can we set different prices for different customers?
-->
### 顧客毎に異なる単価を設定できますか？

<!--
The pricing is currently loaded from a simple JSON configuration file, but the intent is to convert that to a service that an integrator of Abacus can implement to control what price is used for a particular resource, plan, organization, time (as prices evolve over time), country, currency etc.
-->
現在、単価の設定は単純なJSONフォーマットの設定ファイルで行いますが、特定のリソース、計画、組織、時間、国、通貨など応じて単価が制御できるように
Abacusのインテグレーターが実装できるように変換することを目標としています。

<!--
That service will need to implement a REST API that Abacus will call to get the price to use to rate the usage. So, yes, with that you'll be able to return a different pricing per customer (i.e. per organization).
-->
サービスはAbacusが利用量に対する炭化を取得できるようREST APIを実装することが求められます。
そのため、顧客毎(もしくは組織毎)に応じて異なる単価を返すことができます。

